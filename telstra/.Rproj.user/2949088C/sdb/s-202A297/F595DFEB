{
    "contents" : "---\n[comment]: <> (title \"Weissensee results exploration 2014-2016\")\n[comment2]: <> (author \"Ger Inberg\")\n[comment3]: <> (date \"20-01-2016\")\noutput: html_document\n---\n\n# Weissensee results exploration 2014-2016\n\n## Introduction\nOne of my hobbies is ice-skating and in 2015 I have done the \"Alternatieve Elfstedentocht\" for the first time. It is an ice skating event held in Austria, over a distance of 200km ([video](https://www.youtube.com/watch?v=FhdifsMYr8s)). In a period of about 10 days multiple events are held, for professionals as well as for amateurs. \n\nMost participants are from the Netherlands, they are so unfortunate that there is not enough ice on their lakes to organise such an event. Because I was interested in how many people finished the 200km and what the average finish time was, I have done some data analysis.\nFirst I have scraped the data from the Weissensee website to a [csv file](data/weissensee_results.csv), with a [python script](weissensee_scraper.py). Notice: these results are only from the amateur 200km races that are held in the years mentioned above.\n\n[comment4]: <> (<iframe width=\"560\" height=\"315\" src=\"http://youtube.com/embed/FhdifsMYr8s\"; frameborder=\"0\" allowfullscreen></iframe>)\n\n```{r echo=FALSE, message=FALSE, warning=FALSE, packages}\n# Load all of the packages that I need.\n\n# Notice that the parameter \"echo\" was set to FALSE for this code chunk.\n# This prevents the code from displaying in the knitted HTML output.\n\nlibrary(ggplot2)\nlibrary(plyr)\nlibrary(grid)\nlibrary(gridExtra)\n```\n\n## Dataset info\n```{r echo=FALSE, message=FALSE, warning=FALSE, Load_the_Data}\n# Load the Data, combine the two datasets and print some basics\nweissensee <-read.csv(\"data/results.csv\", header=TRUE, sep = \";\") \nstr(weissensee)\n# add year variable for ease of use\nweissensee$Year = as.numeric(format(as.POSIXct(weissensee$Date, format='%d-%m-%Y'), format=\"%Y\"))\n```\n\n[comment5]: <> ( Univariate Plots Section)\n\n### Finish times (200km)\n\nThe event is held at a lake where the participants skate some amount of laps to complete the 200km distance. Mostly a lap is between 10 and 25km, depending on the ice conditions. A larger lap size is supposed to lead to a faster finish time, because bigger groups can form, so there is less air resistance. Also corners slow down. The plot above shows the finish times of all the events. It follows a normal distribution quite well.\n\n```{r echo=FALSE, message=FALSE, warning=FALSE, FinishTimes}\n#finish time 200km\nweissensee200km <- weissensee[as.numeric(as.matrix(weissensee$Distance)) == 200.0, ]\nweissensee200km$TimeFormatted  <- as.POSIXct(strptime(weissensee200km$Time, format=\"%H:%M:%S\"))\nweissensee200km$Year = as.numeric(format(as.POSIXct(weissensee200km$Date, format='%d-%m-%Y'), format=\"%Y\"))\nweissensee200km$nTime <- difftime(strptime(weissensee200km$Time,\"%H:%M:%S\"),\n                     strptime(\"00:00:00\",\"%H:%M:%S\"), units=\"secs\")\n#plot\nggplot(data = weissensee200km, aes(x=TimeFormatted)) + geom_histogram() + \n  ggtitle(\"Distribution of finish times (200km)\") + xlab('Time (hours)') + \n  ylab('count') + geom_vline(xintercept=as.numeric(mean(weissensee200km$TimeFormatted))[1], colour = \"red\")\n#print average,sd\naverage <- format(.POSIXct(mean(weissensee200km$nTime),tz=\"GMT\"), \"%H:%M:%S\")\nsd <- format(.POSIXct(sd(weissensee200km$nTime),tz=\"GMT\"), \"%H:%M:%S\")\nsprintf(\"Average: %s, standard deviation: %s\", average, sd)\n```\n\n### Finish times (200km) per year\n\nDistribution of the finish times per year. The black box is the interquartile range. Since 2016 is not yet complete, it has less points.\n\n```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots}\n# finish times per year\nggplot(data = weissensee200km, aes(x=factor(Year), y=TimeFormatted)) + \n  geom_jitter(alpha=0.1) + geom_boxplot(alpha=0.1) + \n  ggtitle(\"Finish time (200km) per year\") + xlab('Year') + ylab('Time (hours)')\n\n#average finish time per year\nweissensee200km$nTime <- difftime(strptime(weissensee200km$Time,\"%H:%M:%S\"),\n                     strptime(\"00:00:00\",\"%H:%M:%S\"), units=\"secs\")\nweissensee200km.means <- aggregate(weissensee200km$nTime, by=list(weissensee200km$Year), mean)\nweissensee200km.means$Time <- format(.POSIXct(weissensee200km.means$x,tz=\"GMT\"), \"%H:%M:%S\")\nnames(weissensee200km.means) <- c(\"Year\", \"x\", \"Average finish time\")\nweissensee200km.means[, c(1,3)]\n```\n\n### Participants count\n\nThe histogram displays the number of participants per event. Below that the average and total participants per year are given. For the last years, the number of participants are increasing! In 2016 this is probably (partly) caused by the fact that there are 4 events held instead of 3 in the years before.\n\n```{r echo=FALSE, message=FALSE, warning=FALSE, ParticipantsCount}\n# plot participate count in events\ndf <- count(weissensee, \"Date\")\n#change order of levels in order to plot dates in right order\ndf$Date2 <- as.POSIXct(df$Date, format='%d-%m-%Y')\ndf$Date <- factor(df$Date, levels = df$Date[order(df$Date2)])\nggplot(data = df) + geom_histogram(aes(x=Date, y=freq), stat=\"identity\") + \n  scale_y_continuous(breaks = seq(0, 1600, 100)) + \n  ggtitle(\"Number of participants per event\") + xlab('Event (year - event)') + ylab('Count') +\n  scale_x_discrete(labels=c(\"2014-1\",\"2014-2\",\"2014-3\",\"2015-1\",\"2015-2\",\"2015-3\",\"2016-1\",\"2016-2\",\"2016-3\",\"2016-4\"))\n\ngetAverageTotalCountPerYear = function(df, years){\n  result <- c()\n  for(i in 1:length(years)){\n    year <- years[i]\n    dfYear <- df[df$Year == year, ]\n    total <- dim(dfYear)[1] \n    nrOfEvents <- length(unique(dfYear$EventId))\n    average <- total / nrOfEvents\n    newrow = c(year, average, total)\n    result = rbind(result,newrow)\n  }\n  colnames(result) <- c('year','average','total')\n  rownames(result) <- c('','','')\n  result\n}\nyears <- c(2014,2015,2016)\ngetAverageTotalCountPerYear(weissensee, years)\n```\n\n### Participants country of residence\n\nWell, I guess the histogram says it all, you can call this a Dutch event!\n\n```{r echo=FALSE, message=FALSE, warning=FALSE, ParticipantsResidence}\n#country\nggplot(data = weissensee, aes(x=Country)) + geom_histogram() + \n  scale_y_log10() + ggtitle(\"Country of residence of participants\") + \n  xlab('Country') + ylab('count (log scale)')\nsummary(weissensee$Country) \n```\n\n### Completed distance\n\nNot all people can finish the 200km distance, because of various reasons: crashes, bad material, bad condition, etc. Fortunately, one can skate a shorter distance: simply skate less laps. The histogram shows that most people can finish the 200km, 100km is the next best.\n\n```{r echo=FALSE, message=FALSE, warning=FALSE, CoveredDistance}\n#Distance\nggplot(data = weissensee, aes(x=as.factor(Distance))) + geom_histogram() +\n  scale_y_sqrt() + ggtitle(\"Distribution of completed distance\") + \n  xlab('Distance (km)') + ylab('count (sqrt scale)') + \n  scale_x_discrete(breaks = seq(0, 200, 20))\nsummary(weissensee$Distance)\n```\n\n[comment7]: <> ( Multivariate Plots Section)\n## Weissensee to the max\n\nSome participants just can't get enough of ice-skating and are participating multiple times in the event. The event is held 3 or 4 times in a period of 10 days and I am curious who finished all 3 or 4 times in the full distance and what their times were.\n\n```{r echo=FALSE, message=FALSE, warning=FALSE, Triple}\nplotWeissenseeTriple = function(year, yearLabels, n){\n  weissensee_triple <- c()\n  weissenseeYear <- weissensee[weissensee$Year == year, ]\n  weissenseeYear_200k <- weissenseeYear[as.numeric(as.matrix(weissenseeYear$Distance)) == 200.0, ]\n  names <- unique(weissenseeYear_200k$Name)\n  for(i in 1:length(names)){\n    name = names[i]\n    temp <- weissenseeYear_200k[weissenseeYear_200k$Name == name, ]\n    if(nrow(temp) == n){\n      if (length(unique(temp$Date)) == n){\n        weissensee_triple <- rbind(weissensee_triple, temp)\n      }\n    }\n  }\n  weissensee_triple$TimeFormatted  <- as.POSIXct(strptime(weissensee_triple$Time, format=\"%H:%M:%S\"))\n  plot <- ggplot(data = weissensee_triple, aes(x=factor(EventId), y=TimeFormatted, color=Name)) + \n  geom_point() + geom_line(aes(group=Name)) + scale_x_discrete(labels=yearLabels) + \n  xlab('Date') + ylab('Finish time') + ggtitle(year)\n  plot\n}\nplot2014 <- plotWeissenseeTriple(2014, c(\"24-1-14\",\"28-1-14\",\"30-1-14\"), 3)\nplot2015 <- plotWeissenseeTriple(2015, c(\"23-1-15\",\"27-1-15\",\"30-1-15\"), 3)\nplot2016 <- plotWeissenseeTriple(2016, c(\"19-1-16\",\"22-1-16\",\"26-1-16\", \"29-1-16\"), 4)\ngrid.arrange(plot2014, plot2015, plot2016, ncol = 1)\n```\n\nSo, there are a couple brave man that finished all times! Unfortunately, it is hard to see a trend in finish times for these individuals. Some had their fastest time in the first event, some in the second and only one in the last event. Of course, the finish time depends on a lot of factors, including the individuals capabilities, weather conditions, etc.\n\n## Ideas for future work\n* relate finish times to weather conditions (wind, snow conditions, temperature)\n* relate finish times to lap size\n* add results of other years and look for trends\n\n",
    "created" : 1456648704965.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3503395369",
    "id" : "F595DFEB",
    "lastKnownWriteTime" : 1454761508,
    "path" : "~/admin/freelance/weissensee/weissensee.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}